/**
 * ecomplus-render - Vue.js app to render E-Com Plus store template
 * @version v2.10.0
 * @link https://github.com/ecomclub/ecomplus-store-render#readme
 * @author E-Com Club
 * @license MIT
 */
!function(){var i={};!function(){"use strict";var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},r={};i={Ecom:r,root:e,_:{}};var t={Vue:"vue",EcomIo:"ecomplus-sdk"};for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];if(e.hasOwnProperty(o))i[o]=e[o];else{if("function"!=typeof require)return console.error(o+" (`"+n+"`) is required and undefined");i[o]=require(n)}}"undefined"==typeof exports||exports.nodeType?e.Ecom=r:("undefined"!=typeof module&&module.exports&&!module.nodeType&&(exports=module.exports=r),exports.Ecom=r)}(),function(){"use strict";var s=i.root;i._.getCookie=function(e){var r=s.document.cookie;if("string"==typeof r)for(var t=e+"=",o=decodeURIComponent(r).split(";"),n=0;n<o.length;n++){for(var a=o[n];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return null}}(),function(){"use strict";var m=i.root,d=i.Ecom,_=i.EcomIo;if(d&&_){var b,w,l,a=i.Vue,O=i._.getCookie,u=[],p=function(){++w===b&&"function"==typeof l&&l()},s={methods:{}};d.addVueMethod=function(e,t){s.methods[e]=function(){for(var e=[],r=0;r<arguments.length;r++)e.push(arguments[r]);return!e[0]&&this.$data&&(e[0]=this.$data.body),t.apply(null,e)}},a.config.errorHandler=function(e,r,t){console.error(e),console.log("Vue instance with error, $el and $data:"),console.log(r.$el),console.log(r.$data),console.log(t),console.log("-----//-----")};var P=function(e,r,t){if(Array.isArray(t)||(t=[]),e.childNodes)for(var o=0;o<e.childNodes.length;o++){var n=e.childNodes[o],a=n.classList;if(a)for(var s=0;s<a.length;s++)if(a[s]===r){t.push(n);break}P(n,r,t)}return t},f=function(g){var v;v=g.hasOwnProperty("el")?g.el:m.document.getElementsByTagName("BODY")[0];g.hasOwnProperty("store_id")||(g.store_id=O("Ecom.store_id")),g.store_id&&(g.hasOwnProperty("store_object_id")||(g.store_object_id=O("Ecom.store_object_id")),g.lang||(g.lang=O("Ecom.default_lang"))),_.init(function(e,r){if(e)console.error(e);else{var t,o;"object"==typeof r&&null!==r&&(g.store_id=r.store_id,g.store_object_id=r.store_object_id,!g.lang&&r.default_lang&&(g.lang=r.default_lang));var n=P(v,"_ecom-el");b=w=0;var a,s,i,c,l,u={};for(t=0;t<n.length;t++){var f=!1,d=!1,p=(o=n[t]).dataset.type;switch(p){case"product":case"brand":case"collection":case"customer":case"cart":case"order":case"application":case"store":a=p+"s";break;case"category":a=p.slice(0,-1)+"ies";break;case"related":case"recommended":f=!0,a=p;break;case"items":x(g,o),b++,d=!0;break;default:console.log("Ignored element, invalid type:"),console.log(o),d=!0}!0!==d&&(i=c=!1,(s=o.dataset.id)||("stores"===a?s=g.store_object_id:o.dataset.hasOwnProperty("listAll")&&!f?i=!0:(l||(l=!0),c=!0)),j(u,o,a,s,i,c,f))}if(!0===l){var y={};if(m.location){var h=m.location.pathname;h&&h===O("Ecom.current.path")&&(y.resource=O("Ecom.current.resource"),y._id=O("Ecom.current._id"))}y.resource&&y._id?A(g,u,y):_.mapByWindowUri(function(e,r){e?console.error(e):A(g,u,r)})}else A(g,u)}},g.store_id,g.store_object_id)},j=function(e,r,t,o,n,a,s){var i;n||a?(i=t,a&&(i+="&")):i=o,s&&(i=t+"/"+i),e.hasOwnProperty(i)?e[i].resource===t?e[i].els.push(r):(console.log("Ignored element, different types for same id (?):"),console.log(r)):e[i]={resource:t,id:o,list:n,current:a,els:[r],graphs:s}},A=function(f,o,n){var a;for(var s in o)o.hasOwnProperty(s)&&function(){var c=o[s],e=c.resource,r=c.id,l=c.graphs,u=c.els,t=function(e,r){if(e)console.error(e),p();else{for(var t=0;t<u.length;t++){var o=u[t];if(l||o.dataset.hasOwnProperty("list")){var n,a=o.dataset.list;if(l){if(n=[],Array.isArray(r.results)&&r.results.length){var s=r.results[0].data;if(s)for(var i=0;i<s.length;i++)n.push(s[i].row)}}else r.hasOwnProperty(a)&&(n=r[a]);Array.isArray(n)?o.dataset.ids=n.join():"string"==typeof n&&(o.dataset.ids=n),x(f,o,r)}else y(f,o,r)}c.current&&r._id&&(d.currentObject=r)}};l?(a="related"===e?"listRelatedProducts":"listRecommendedProducts",c.current?"products"===n.resource?_[a](t,n._id):(console.log("Ignored elements, product id undefined for Graphs method:"),console.log(c.els)):_[a](t,r)):c.list?(a="list"+e.charAt(0).toUpperCase()+e.slice(1),_.hasOwnProperty(a)?_[a](t):(console.log("Ignored elements, list all unavailable for this resource:"),console.log(c.els))):c.current?e===n.resource?_.getById(t,e,n._id):(console.log("Ignored elements, id undefined and type does not match with URI resource:"),console.log(c.els)):_.getById(t,e,r),b+=u.length}()},x=function(t,o,n){var e={};for(var r in o.dataset)if(o.dataset.hasOwnProperty(r))switch(r){case"term":e[r]=o.dataset[r];break;case"from":case"size":case"sort":e[r]=parseInt(o.dataset[r],10);break;case"ids":case"brands":case"categories":e[r]=o.dataset[r].split(",");break;case"priceMin":e.hasOwnProperty("prices")||(e.prices={}),e.prices.min=parseFloat(o.dataset[r]);break;case"priceMax":e.hasOwnProperty("prices")||(e.prices={}),e.prices.max=parseFloat(o.dataset[r]);break;default:if(r.startsWith("spec")){e.hasOwnProperty("specs")||(e.specs={});var a=r.charAt(4).toLowerCase()+r.substr(5),s=o.dataset[r];if("["===s.charAt(0))try{var i=JSON.parse(s);Array.isArray(i)&&(e.specs[a]=i)}catch(e){}e.specs.hasOwnProperty(a)||(e.specs[a]=[s])}}_.searchProducts(function(e,r){e?(console.error(e),p()):("object"==typeof n&&null!==n&&(r=Object.assign(n,r)),y(t,o,r))},e.term,e.from,e.size,e.sort,e.specs,e.ids,e.brands,e.categories,e.prices)},y=function(e,r,t,o){e?t.Store=e:u.length&&(t.Store=u[0]);var n={body:t};if(r.dataset.hasOwnProperty("payload"))try{n.payload=JSON.parse(r.dataset.payload)}catch(e){console.log("Ignoring invalid element payload:"),console.log(r)}d.hasOwnProperty("currentObject")||"true"!==r.dataset.current||(d.currentObject=t),new a({mixins:[s],el:r,data:n,destroyed:function(){var e=this.$el;"object"==typeof e&&null!==e&&e.classList&&e.classList.add("rendered"),p(),"function"==typeof o&&o()}}).$destroy()};d.stores=function(){return u},d.render=y,d.methods=s.methods,d.init=function(e,r,t,o,n){var a,s;if(console.log("Init E-Com Plus store rendering"),n)m.document=n;else if(!m.document)return void console.error("Root `document` (DOM) object is undefined or invalid");if(r&&t)s={store_id:parseInt(r,10),store_object_id:t},o&&(s.lang=o),u.push(s);else{var i=m.document.getElementsByClassName("_ecom-store");if("object"==typeof i&&null!==i)for(a=0;a<i.length;a++){var c=i[a];s={el:c},c.dataset.store&&c.dataset.id&&(s.store_id=parseInt(c.dataset.store,10),s.store_object_id=c.dataset.id),c.dataset.lang&&(s.lang=c.dataset.lang),u.push(s)}}u.length&&(l=function(){++a<u.length?f(u[a]):"function"==typeof e&&e()},f(u[a=0]))}}}(),function(){"use strict";var e=i.Ecom;if(e){var r=e.addVueMethod;if("function"==typeof r){var o=function(e,r){if("object"==typeof e&&null!==e){if(!e.hasOwnProperty("size"))return o(e.logo);var t=e.size.split("x");if(2===t.length)return t[r]}return null},d={name:function(e,r){return!r&&"object"==typeof this&&null!==this&&this.Store&&(r=this.Store.lang),r&&e.hasOwnProperty("i18n")&&e.i18n.hasOwnProperty(r)?e.i18n[r]:e.name},width:function(e){o(e,0)},height:function(e){o(e,1)},price:function(e){return!e.hasOwnProperty("base_price")||d.onPromotion(e)?e.price:e.base_price},minQuantity:function(e){return e.min_quantity||1},inStock:function(e){return!e.hasOwnProperty("quantity")||e.quantity>=d.minQuantity(e)},formatMoney:function(e,r,t,o){if(r||(r=","),t||(t="."),o||(o=2),"object"==typeof e?null!==e&&(e=d.price(e)):"string"==typeof e&&(e=parseFloat(e)),"number"!=typeof e||isNaN(e)){for(var n="0"+r,a=0;a<o;a++)n+="0";return n}return e.toFixed(o).replace(t,r).replace(/(\d)(?=(\d{3})+,)/g,"$1.")},onPromotion:function(e){if(e.hasOwnProperty("price_effective_date")){var r=new Date;if(e.price_effective_date.hasOwnProperty("start")&&new Date(e.price_effective_date.start)<r)return!1;if(e.price_effective_date.hasOwnProperty("end")&&new Date(e.price_effective_date.end)>r)return!1}return!(!e.hasOwnProperty("price")||!e.hasOwnProperty("base_price"))},alphabeticalSort:function(e){if(Array.isArray(e))e.sort(function(e,r){return e.name<r.name?-1:1});else if("object"==typeof e&&null!==e)return d.alphabeticalSort(e.results);return e},findByProperty:function(e,r,t){if(Array.isArray(e))for(var o=0;o<e.length;o++){var n=e[o];if(n&&n[r]===t)return n}},findBySlug:function(e,r){if(Array.isArray(e))return d.findProperty(e,"slug",r)},filterByParentSlug:function(e,r){var t=[];if(Array.isArray(e))for(var o=0;o<e.length;o++){var n=e[o];n.parent&&n.parent.slug===r&&t.push(n)}return t},splitCategoryTree:function(e){var r,t=[];if(r="string"==typeof e?e:e.category_tree){t=r.split(">");for(var o=0;o<t.length;o++)t[o]=t[o].trim()}return t},specValues:function(e,r){var t=[];if(Array.isArray(e))t=e;else{var o=e.specifications;if(o)for(var n in o)o.hasOwnProperty(n)&&n===r&&(t=o[r])}return t},specTextValue:function(e,r,t){var o=d.specValues(e,r);if(o.length){var n=o[0].text;t||(t=", ");for(var a=1;a<o.length;a++)n+=t+o[a].text;return n}return null},specValueByText:function(e,r,t){for(var o=d.specValues(e,r),n=0;n<o.length;n++)if(o[n].text===t)return o[n].value},variationsGrids:function(e,r,t){var o={};if(e.hasOwnProperty("variations"))for(var n=0;n<e.variations.length;n++){var a=e.variations[n],s=a.specifications,i=function(e){return d.specTextValue(a,e,t)};if(s){if(r){var c=!1;for(var l in r)if(r.hasOwnProperty(l)&&(!s[l]||i(l)!==r[l])){c=!0;break}if(c)continue}for(var u in s)if(s.hasOwnProperty(u)){var f=i(u);if(o.hasOwnProperty(u)){if(-1!==o[u].indexOf(f))continue}else o[u]=[];o[u].push(f)}}}return o}};for(var t in d)d.hasOwnProperty(t)&&r(t,d[t])}}}()}();